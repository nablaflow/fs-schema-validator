#!/usr/bin/env python

import sys

from fs_schema_validator import Schema

if __name__ == '__main__':
    with open(sys.argv[1]) as f:
        schema = Schema.from_yaml(f)

    report = schema.validate_()

    if len(report.errors) == 0:
        print("✅ All good!")
        sys.exit(0)

    print(f"Found {len(report.errors)} validation error(s):")
    print("")

    for path, reasons in report.grouped_by_path():
        print(f"❗️ path: `{path}`")

        if len(reasons) == 1:
            print(f"   reason: {reasons[0]}")
        else:
            print("   reasons:")
            for reason in reasons:
                print(f"      - {reason}")

    sys.exit(1)
